---
layout: default
---

<head>
    <link rel="stylesheet" href="../../css/index.css">
</head>

<body>
<!-- Side navigation -->
<div class="sidenav">
    <a href="../../index.html" class="nav1">Introduction</a>
    <a href="../gettingstarted.html" class="nav1">Getting started</a>
    <a href="../modules.html" class="nav1">Modules</a>
    <a href="../modulelist.html" class="nav2">List of modules</a>
    <a href="../macros.html" class="nav1">Macros</a>
    <a href="../extendingmia.html" class="nav1">Extending MIA</a>
</div>

<!-- Page content -->
<div class="main">
    <!--The following is replaced automatically by the generated module list-->
    <a href="../modulelist.html">Back to module list</a>
<h1>Output control</h1>
<h2>Description</h2>
Controls data export for each analysis run (job) as well as providing the option to run a final macro on all data.  If running a single file analysis, by default, the spreadsheet will be saved with the same name as the input file and stored at the same location.  Whereas, in batch mode (running multiple files from a folder) the spreadsheet will be saved in that folder with the same name as the input folder.  Using the "Group save location" parameter it's possible to redirect the output spreadsheet(s) to a specific location.<br><br>Data can be collated into a single Excel spreadsheet, or exported as one spreadsheet per analysis run (job).  Exported spreadsheets are separated into multiple sheets:<br><ul><li>"Parameters" An overview of the analysis setup (path to workflow file, date run, computer operating system) along with a list of all modules and parameters, their values and states.  The information here should be sufficient to reconstruct the analysis workflow in the absence of the original workflow file.</li><li>"Log" A list of any error messages presented to the user while the analysis was running.</li><li>"Summary" Each analysis run is summarised by a single line (or one line per timepoint or metadata value, if selected) containing metadata values, image measurements, the number of objects detected as well as statistics for object collections (e.g. mean of a particular measurement).  The summary sheet is intended to facilitate quick analysis; all data contained in this sheet (with the exception of image measurements) can be manually compiled from the individual object sheets.  This sheet can be enabled/disabled using the "Export summary" parameter.</li><li>"[Object-specific sheets]" Each object collection can export to a separate sheet.  These sheets contain one row per object in that collection and include metadata values, along with all measurements and relationships for that object.  This sheet can be enabled/disabled using the "Export individual objects" parameter.</li></ul><br>It's also possible to select the data to be exported for each sheet, including the metadata values (filename, series number, etc.), individual measurements and object collection statistics.
<h2>Parameters</h2>
<ul><li>Run macro<ul><li>Description: When selected, a final macro can be run once all the analysis runs (jobs) have been completed.  By using the workspace handling macros ("MIA_GetListOfWorkspaceIDs" and "MIA_SetActiveWorkspace") it's possible to switch between workspaces, thus facilitating dataset-wide analyses.  This macro will be executed only once as part of the final data exporting phase of the analysis.</li><li>Type: BooleanP</li><li>Default value: false</li></ul><br><li>Add variable<ul><li>Description: Pre-define variables, which will be immediately accessible within the macro.  These can be used to provide user-controllable values to file-based macros or to prevent the need for editing macro code via the "Output control" panel.</li><li>Type: ParameterGroup</li></ul><br><li>Macro mode<ul><li>Description: Select the source for the macro code:<br><ul><li>"Macro file" Load the macro from the file specified by the "Macro file" parameter.</li><li>"Macro text" Macro code is written directly into the "Macro text" box.</li></ul></li><li>Type: ChoiceP</li><li>Default value: Macro text</li><li>Choices: <ul><li>Macro file</li><li>Macro text</li></ul></li></ul><br><li>Macro text<ul><li>Description: Macro code to be executed.  MIA macro commands are enabled using the "run("Enable MIA Extensions");" command which is included by default.  This should always be the first line of a macro if these commands are needed.</li><li>Type: TextAreaP</li><li>Default value: run("Enable MIA Extensions");

// Get a list of Workspace IDs with Ext.MIA_GetListOfWorkspaceIDs() and set active workspace with Ext.MIA_SetActiveWorkspace(ID).</li></ul><br><li>Macro file<ul><li>Description: Select a macro file (.ijm) to run once, after all analysis runs have completed.</li><li>Type: FilePathP</li></ul><br><li>Export mode<ul><li>Description: Controls the number of results spreadsheets that are exported and what they contain:<br><ul><li>"All together" Results from all current analysis runs are grouped into a single spreadsheet.  The same sheets are used for all runs, so it's necessary to include a filename (and where necessary, a series name/number) metadata identifier.  Unless "Save name mode" is set to "Specific name", this file is named after the input file/folder.</li><li>"Group by metadata" Results are grouped and exported by a specific metadata item associated with each analysis run.  Unless "Save name mode" is set to "Specific name", the files are named in the format "[input file/folder name]_[metadata name]-[metadata value]".  The metadata item to group on is specified by the "Metadata item for grouping" parameter.</li><li>"Individual files" A separate results spreadsheet is saved for each analysis run.</li><li>"None" No results spreadsheets are exported.</li></ul></li><li>Type: ChoiceP</li><li>Default value: All together</li><li>Choices: <ul><li>All together</li><li>Group by metadata</li><li>Individual files</li><li>None</li></ul></li></ul><br><li>Individual save location<ul><li>Type: ChoiceP</li><li>Default value: Save with input file</li><li>Choices: <ul><li>Mirrored directory</li><li>Save with input file</li><li>Specific location</li></ul></li></ul><br><li>Group save location<ul><li>Type: ChoiceP</li><li>Default value: Save with input file</li><li>Choices: <ul><li>Save with input file</li><li>Specific location</li></ul></li></ul><br><li>File path<ul><li>Type: FolderPathP</li></ul><br><li>Mirrored directory root<ul><li>Type: FolderPathP</li></ul><br><li>Save name mode<ul><li>Type: ChoiceP</li><li>Default value: Match input file/folder name</li><li>Choices: <ul><li>Match input file/folder name</li><li>Specific name</li></ul></li></ul><br><li>File name<ul><li>Type: StringP</li></ul><br><li>Metadata item for grouping<ul><li>Description: If "Export mode" is set to "Group by metadata", results will be grouped and saved by the value of this metadata item associated with each analysis run.  There will be one results spreadsheet for each unique value of this metadata item.</li><li>Type: MetadataItemP</li></ul><br><li>Continuous data export<ul><li>Description: When selected, the results spreadsheet(s) can be exported at intervals during a multi-analysis run.  They will be exported every N runs, where N is controlled by the "Save every n files" parameter.  The spreadsheet(s) will still be stored when all analysis runs have completed.</li><li>Type: BooleanP</li><li>Default value: false</li></ul><br><li>Save every n files<ul><li>Description: If "Continuous data export" is enabled, the current version of the spreadsheet will be exported after every N analysis runs.  This means if the analysis fails or the computer crashes, results collected so far are not lost.</li><li>Type: IntegerP</li><li>Default value: 10</li></ul><br><li>Append date/time mode<ul><li>Type: ChoiceP</li><li>Default value: Never</li><li>Choices: <ul><li>Always</li><li>If file exists</li><li>Never</li></ul></li></ul><br><li>Export summary<ul><li>Type: BooleanP</li><li>Default value: true</li></ul><br><li>Summary mode<ul><li>Type: ChoiceP</li><li>Default value: Per input file</li><li>Choices: <ul><li>Per input file</li><li>Per timepoint per input file</li><li>Group by metadata</li></ul></li></ul><br><li>Metadata item for summary<ul><li>Type: MetadataItemP</li></ul><br><li>Show object counts<ul><li>Type: BooleanP</li><li>Default value: true</li></ul><br><li>Export individual objects<ul><li>Type: BooleanP</li><li>Default value: true</li></ul><br></ul>

</div>
</body>